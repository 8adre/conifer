{% extends "main_bootstrap.html" %}

{% block head %}

{{ super() }}

<link href="/static/__shared/external/bootstrap-markdown.min.css" rel="stylesheet">
<script src="/static/__shared/external/marked.min.js"></script>
<script src="/static/__shared/external/bootstrap-markdown.js"></script>

<script src="/static/__shared/editor.js"></script>

{% endblock %}

{% block content %}

<div class="jumbotron">
    {% if is_owner() %}
    <button id="home-edit" class="btn btn-success btn-sm pull-right" data-toggle="button" aria-pressed="false">Edit</button>
    {% endif %}

    <div id="about">
        <div id="home-markdown" style="display: none">{{desc}}</div>
        <div id="home-view"></div>
    </div>

    <ul class="list-group text-center">
        {% for name, value in colls | dictsort %}
        <li class="list-group-item">
            <a href="/{{ value.path }}" style="font-size: 20px">{{ value.title | default(name) }}</a>
            <p class="colls-size pull-right" data-size="{{ value.size }}" style="font-size: 14px"></p>
        </li>
        {% endfor %}
        {#
        {% if is_owner() %}
        <p style="font-size: 14px; padding: 4px 17px 0px 0px;" data-size="{{ total_size }}" class="colls-size pull-right"></p>
        {% endif %}
        #}
    </ul>
    {% if not colls %}
    <p class="text-center" style="font-style: italic">
        {% if is_owner() %}
        No Collections
        {% else %}
        No Available Collections
        {% endif %}
    </p>
    {% endif %}

    {% if is_owner() %}
    <p><a class="btn btn-primary btn-sm" href="/_create" role="button">
        <span class="glyphicon glyphicon-plus" style="margin-right: 4px"></span>Create new Collection</a></p>
    {% endif %}
</div>


{% if is_owner() %}
<div class="row col-md-6">
    <div class="alert alert-danger">
        <b>Permanently delete this account?</b>
        <p>This action can not be undone!</p>
        <button class="btn btn-sm btn-danger" data-toggle="modal" data-target="#confirm-delete-modal">Delete Account</button>
    </div>
</div>

<div class="modal fade" id="confirm-delete-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                Confirm Delete Collection?
            </div>
            <div class="modal-body">
                Are you sure you want to delete the <b>{{user}}</b> account?
                If you continue, all archived data in all collections will be permanently deleted.
                You will need to re-register to use the service again.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <form style="display: inline" method="post" action="/_delete_account?user={{user}}">
                    <button type="submit" class="btn btn-danger btn-ok" id="confirm-delete">Confirm Delete</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endif %}

<script>
    $(function() {
        $(".colls-size").each(function(i, elem) {
            $(elem).text(format_bytes($(elem).attr("data-size")));
        });
    });

    init_markdown_editor("{{user}}");
</script>

{% endblock %}
