{% extends "main_bootstrap.html" %}

{% block head %}

{{ super() }}

<script>
$(function() {
    $("input[name='move-temp']").on("change", function() {
        if ($(this).attr("value") == "1") {
            $("#to_coll").parent().show();
            $("#to_coll").attr("required", "true");
        } else {
            $("#to_coll").parent().hide();
            $("#to_coll").attr("required", "false");
        }
    });
});
</script>

{% endblock %}

{% block content %}
<div class="row">
    {% if (not email or not invite) and not skip_invite %}
    <div class="col-sm-8 col-md-6 col-md-offset-2">
        <h2>Webrecorder.io Invite Request</h2>

        <h4>For now, the webrecorder.io beta is available on a limited basis.</h4>
        <h4>To request an invite, please fill out the form below.</h4>
        <h4>You'll receive an invitation
            code allowing you to register as soon as we are ready!</h4>
    </div>
    <div class="col-sm-6 col-md-4 col-md-offset-2">
        <form id="invite" action="/_invite" method="post" role="form" data-toggle="validator" data-delay="1000">
            <div class="form-group">
                <label for="username" class="sr-only">Name:</label>
                <input type="text" id="name" name="name" class="form-control" placeholder="Your Name" required="true" data-delay="1000"/>
                <div class="help-block with-errors"></div>
            </div>
            <div class="form-group">
                <label for="email" class="sr-only">Email</label>
                <input type="email" id="email" name="email" class="form-control" placeholder="Your Email" required="true">
                <div class="help-block with-errors"></div>
            </div>
            <div class="form-group">
                <label for="desc" class="sr-only">Other Comments:</label>
                <textarea type="text" id="desc" name="desc" class="form-control" maxlength="100" placeholder="Field of interest / other comments (optional)"></textarea>
                <div class="help-block with-errors"></div>
            </div>
            <button class="btn btn-lg btn-primary btn-block" type="submit">Request Invite</button>
        </form>
    </div>

    {% else %}

    <div class="col-sm-8 col-md-6 col-md-offset-2">
        <h2>Webrecorder.io Account Sign-Up</h2>

        <h4>Create your own web archive as you browse!</h4>
        <br/>
        <h4>To begin, please fill out the registration form below.</h4>
        <br/>
   </div>

    <div class="col-sm-6 col-md-4 col-md-offset-2">
        <form id="register" method="post" role="form" data-toggle="validator" data-delay="1000">
            <div class="form-group">
                <h5 class="">Choose a username for your archive </h5>

                <label for="username" class="sr-only">Username</label>
                <input type="text" id="username" name="username" class="form-control" placeholder="username" required="true" 
                       pattern="[A-Za-z0-9][\w-]{2,15}" data-error="Usernames must be 3-16 characters, and start with letter or digit and contain only letters, digit or -" autofocus="true" data-delay="1000">
                <div class="help-block with-errors"></div>
            </div>

            <div class="form-group">
                <label for="email" class="sr-only">Email</label>
                <input type="email" id="email" name="email" class="form-control" value="{{ email }}" placeholder="Your Email" required="true">
                <div class="help-block with-errors"></div>
            </div>
            
            <input type="hidden" name="invite" value="{{invite}}"/>

            <div class="form-group">
                <label for="password" class="sr-only">Password</label>
                <input type="password" id="password" data-minlength="8" name="password" class="form-control" placeholder="Password" required="true"
                       pattern="(?=.*[\d\W])(?=.*[a-z])(?=.*[A-Z]).{8,}" data-error="Password must be at least 8 characters and contain lower, uppercase, and either digits or symbols">
                <div class="help-block with-errors"></div>
            </div>

            <div class="form-group">
                <label for="password" class="sr-only">Confirm Password</label>
                <input type="password" id="confirmpassword" data-minlength="8" data-match="#password" name="confirmpassword" class="form-control" 
                       placeholder="Confirm Password" required="true" pattern="(?=.*[\d\W])(?=.*[a-z])(?=.*[A-Z]).{8,}" data-error="Password must be at least 8 characters and contain lower, uppercase, and either digits or symbols" data-match-error="Password confirmation does not match">
                <div class="help-block with-errors"></div>
            </div>

        {% if anon_size and anon_recordings %}
            <div class="alert alert-info" role="alert">

                <div class="form-group">
                    {% set path = get_path(anon_user, 'temp') %}
                    <h5>You have recorded <a href="{{ path }}"><b data-size="{{ anon_size }}"></b></a> in <a href="{{ path }}"><b>{{ anon_recordings }}</b></a> recording(s)</h5>
                    <input style="" id="coll-move" type="radio" name="move-temp" value="1" aria-label="Move" required="true">
<h5 style="display: inline">Add recordings to new collection in my account.</h5></input><br/>
                    <input style="" id="coll-delete" type="radio" name="move-temp" value="0" aria-label="Delete" required="true">
<h5 style="display: inline">Delete this temporary collection.</h5></input>

                   <div class="help-block with-errors"></div>
                </div> 

                <div class="form-group">
                    <label for="collection_name" class="sr-only">Collection Name</label>
                    <input type="text" id="to-coll" name="to-coll" class="form-control" value="{{ email }}" placeholder="New Collection Name" required="true">

                    <div class="help-block with-errors"></div>
                </div>
            </div>
        {% endif %}

            <button class="btn btn-lg btn-primary btn-block" type="submit">Register</button>
        </form>
    </div>
    {% endif %}
</div>
{% endblock %}
